<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/d-din" type="text/css"/>
        <link href="https://fonts.googleapis.com/css2?family=Sen:wght@800&display=swap" rel="stylesheet">
        <link href="../../../assets/css/habitat.css" rel="stylesheet">
        <link href="../../../theme/assets/css/theme.css" rel="stylesheet">
    </head>

    <body>
    
        <div class="header-image row min-vh-lg-90 ">
            <div class="header-images header-image-left header-image-left-md order-2 order-md-1 py-4 col-md min-vh-lg-90 min-vh-md-75 min-vh-sm-55 min-vh-55 ">
                <div class="layer layer-md"></div>
            </div>
            <div class=" header-images header-image-right order-1 order-md-2 py-4 col-md min-vh-lg-90 min-vh-md-75 min-vh-lg-90 min-vh-sm-35 min-vh-35 max-vh-sm-35 max-vh-35 display-sm">
                <div class="habitat-landing-container py-2 font--lt">
                    <div class="habitat-landing-desc habitat-landing-desc-lg landing-desc-margin-md">
                        Habitat is a Breeding Ground for Artists and Scientists.</div>
                    <div class="habitat-landing-subtitle order-md-2 pt-2 pb-4 text-left subtitle-sm subtitle-md subtitle-lg landing-subtitle-margin-md">
                        Every Single Living Being is Part of an Ecosystem.</div>
                    <div class="habitat-landing-button habitat-landing-button-md habitat-landing-button-lg">
                        <div class="wrapper wrapper-md wrapper-lg">
                            <div class="link_wrapper">
                                {{#if session.userId}}
                                    <a class="landing-button-link-orange" href="/account" target="_blank">Update Profile</a>
                                {{else}}
                                    <a class="habitat-landing-button-link" href="/account" target="_blank">Join Now!</a>
                                    <div class="arrow-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 268.832 268.832">
                                    <path d="M265.17 125.577l-80-80c-4.88-4.88-12.796-4.88-17.677 0-4.882 4.882-4.882 12.796 0 17.678l58.66 58.66H12.5c-6.903 0-12.5 5.598-12.5 12.5 0 6.903 5.597 12.5 12.5 12.5h213.654l-58.66 58.662c-4.88 4.882-4.88 12.796 0 17.678 2.44 2.44 5.64 3.66 8.84 3.66s6.398-1.22 8.84-3.66l79.997-80c4.883-4.882 4.883-12.796 0-17.678z"/>
                                    </svg>
                                    </div>
                                {{/if}}
                            </div>
                        </div>
                    </div>

                    <div class="habitat-landing-searchSection habitat-landing-searchSection-md">
                        <form>
                        <input type="text" 
                        placeholder="Discover Our Members" id="search-input"
                        class="habitat-landing-searchInput"
                        {{#if query}}
                            value="{{query}}" data-query="{{query}}"
                        {{/if}}/>
                        </form>
                    </div>
                    
                </div>
            </div>
        </div>


<!-- <div class="header-image py-4">
    <h1 class="d-flex justify-content-center caption__main">HABITAT</h1>
    <h4 class="d-flex justify-content-center text-center caption__sub font--lt">HABITAT is an art/science community of
        scientists, filmmakers and artists.</h4>
    <h4 class="d-flex justify-content-center text-center caption__sub font--lt pt-2"><strong>Discover our
        members.</strong></h4>
    <h4 class="d-flex justify-content-center text-center caption__sub font--lt pt-2"><a
            class="text-white text-underline cursor-pointer" href="/account" target="_blank"> Tell us more about
        yourself by updating your Account Profile</a></h4>

    <div id="content">
        <div class="search__container">
            <input class="search__input" type="text" placeholder="Search" id="search-input"
                {{#if query}}
                   value="{{query}}" data-query="{{query}}"
                {{/if}}>
        </div>
    </div>

</div> -->

<div class="container mt-4">
    <div class="row g-0 mt-3" id="search-results">

    <!--        {{#each profiles }}-->
        <!--            <div class="col-lg-3 col-md-6 pe-lg-2 mb-2">-->
        <!--                <a href="/habitat/{{this.habitat_handle}}" target="_blank">-->
        <!--                    <div class="card h-100 overflow-hidden bg-dark">-->
        <!--                        <div class="card-header position-relative justify-content-center d-flex mb-7 mt-7">-->
        <!--                            <div class="bg-holder rounded-3 rounded-bottom-0 bg-dark">-->
        <!--                            </div>-->
        <!--                            <div class="avatar avatar-5xl avatar-profile">-->
        <!--                                <img class="rounded-circle img-thumbnail shadow-sm"-->
        <!--                                     src="{{#if
                this.profile_img_url}}{{this.profile_img_url}}{{else}}https://firebasestorage.googleapis.com/v0/b/labocine-188b4.appspot.com/o/static%2Fdefault_profile.png?alt=media&token=288be79d-192c-4bcb-bfbb-8a9dacab753a{{/if}}"-->
        <!--                                     width="200" alt="">-->
        <!--                            </div>-->
        <!--                        </div>-->
        <!--                        <div class="card-body mt-1 bg-dark">-->
        <!--                            <h5 class="text-white text-center">{{this.first_name}} {{this.last_name}}</h5>-->
        <!--                            <h6 class="fs-0 fw-normal text-white text-center text-capitalize text-ellipsis--2 titles">{{addSpace
                this.title}}</h6>-->
        <!--                        </div>-->
        <!--                    </div>-->
        <!--                </a>-->
        <!--            </div>-->
            <!--        {{/each}}-->

    </div>

</div>

<div class="container section-hidden" id="search-results-pagination">
    <div class="row justify-content-center text-center">
        <div class="col-lg-8">
            <button class="btn btn-outline-dark border-2 rounded-pill btn-lg mt-4 fs-0 py-2" type="button"
                    id="load-more-button">Load More
            </button>
        </div>
    </div>
</div>

    </body>


<script src="https://www.labocine.com/assets/js/jquery-3.0.0.min.js"></script>
<!-- for the search only version -->
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>

<script>

    $(document).ready(function () {
        const client = algoliasearch('D1AED1F5RB', 'f6cecab9ea18a08c32aa7fc59d0c406c');
        const index = client.initIndex('habitat');

        // To handle search input when typed in search box
        const source = document.getElementById('search-input');
        const inputHandler = async function (e) {
            query = e.target.value;
            page = 0;
            await search(query, page);
        }
        source.addEventListener('input', inputHandler);
        source.addEventListener('propertychange', inputHandler); // for IE8
        // To handle search input when typed in search box

        let query = '';
        let page = 0;
        search(query, page);

        async function search(query = '', page = 0, append = false) {
            let searchResults;

            searchResults = await index.search(query, {page: page});

            if (append === false) {
                let resultsSection = document.getElementById('search-results');
                resultsSection.innerHTML = '';
                $("search-results").empty();
            }

            if (searchResults.hits) {
                if (page === 0 && query === '') {
                    const shuffle = array =>
                            [...Array(array.length)]
                                    .map((el, i) => Math.floor(Math.random() * i))
                                    .reduce((a, rv, i) => ([a[i], a[rv]] = [a[rv], a[i]]) && a, array);

                    searchResults.hits = shuffle(searchResults.hits);
                }
                searchResults.hits.map(function (result) {
                    createResultsNodes(result);
                });
            }
            updatePagination(searchResults);
        }


        function createResultsNodes(result) {

            let resultsSection = document.getElementById('search-results');

            let mainDiv = createNode('div');
            mainDiv.className += "col-lg-3 col-md-6 pe-lg-2 mb-2";

            let mainAnchor = createNode('a');
            mainAnchor.href = `/habitat/${result.habitat_handle}`;
            mainAnchor.target = "_blank";

            let cardDiv = createNode('div');
            cardDiv.className += "card h-100 overflow-hidden bg-dark";

            let cardHeaderDiv = createNode('div');
            cardHeaderDiv.className += "card-header position-relative justify-content-center d-flex mb-7 mt-7";

            let cardBgHolderDiv = createNode('div');
            cardBgHolderDiv.className += "bg-holder rounded-3 rounded-bottom-0 bg-dark";

            let cardAvatarDiv = createNode('div');
            cardAvatarDiv.className += "avatar avatar-5xl avatar-profile";

            let img = createNode('img');
            img.className += "rounded-circle img-thumbnail shadow-sm";
            if (result.profile_img_url) {
                img.src = result.profile_img_url;
            } else {
                img.src = "https://firebasestorage.googleapis.com/v0/b/labocine-188b4.appspot.com/o/static%2Fdefault_profile.png?alt=media&token=288be79d-192c-4bcb-bfbb-8a9dacab753a";
            }
            img.alt = 'No IMG';
            img.width = "200";

            let cardBodyDiv = createNode('div');
            cardBodyDiv.className += "card-body mt-1 bg-dark";

            let nameDiv = createNode('h5');
            nameDiv.className += "text-white text-center";
            nameDiv.innerHTML = result.first_name + " " + result.last_name;

            let titleDiv = createNode('h6');
            titleDiv.className += "fs-0 fw-normal text-white text-center text-capitalize text-ellipsis--2 titles";
            titleDiv.innerHTML = result.title;

            append(resultsSection, mainDiv);
            append(mainDiv, mainAnchor);
            append(mainAnchor, cardDiv);

            append(cardDiv, cardHeaderDiv);
            append(cardHeaderDiv, cardBgHolderDiv);
            append(cardHeaderDiv, cardAvatarDiv);
            append(cardAvatarDiv, img);

            append(cardDiv, cardBodyDiv);
            append(cardBodyDiv, nameDiv);
            append(cardBodyDiv, titleDiv);

        }


        function updatePagination(searchResults) {

            if ((searchResults.nbPages && searchResults.nbPages > 1) && (searchResults.nbPages - 1 > searchResults.page)) {
                $("#search-results-pagination").removeClass("section-hidden");

            } else {
                $("#search-results-pagination").addClass("section-hidden");
            }
        }

        $("#load-more-button").click(function () {
            page = page + 1;
            search(query, page, true)
        });

    });


    function createNode(element) {
        return document.createElement(element);
    }

    function append(parent, el) {
        return parent.appendChild(el);
    }

    function redirect(link) {
        window.location.href = link;
    }
</script>



</html>
